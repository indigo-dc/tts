
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>OpenId Connect Provider Settings Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="config_service.html" />
    
    
    <link rel="prev" href="config_server.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="user.html">
            
                <a href="user.html">
            
                    
                    User Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="admin.html">
            
                <a href="admin.html">
            
                    
                    Deployment And Administration Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="config.html">
            
                <a href="config.html">
            
                    
                    Configuration Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="config_example.html">
            
                <a href="config_example.html">
            
                    
                    Config Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="config_server.html">
            
                <a href="config_server.html">
            
                    
                    Server Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.3" data-path="config_provider.html">
            
                <a href="config_provider.html">
            
                    
                    OpenId Connect Provider Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="config_service.html">
            
                <a href="config_service.html">
            
                    
                    Service Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="config_rsp.html">
            
                <a href="config_rsp.html">
            
                    
                    RSP Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="config_ssh.html">
            
                <a href="config_ssh.html">
            
                    
                    SSH for WaTTS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="developer.html">
            
                <a href="developer.html">
            
                    
                    Developer Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="rsp.html">
            
                <a href="rsp.html">
            
                    
                    Relying Service Provider (RSP) Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="api.html">
            
                <a href="api.html">
            
                    
                    REST Api
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="service_ref_card.html">
            
                <a href="service_ref_card.html">
            
                    
                    WaTTS - Service Reference Card
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >OpenId Connect Provider Settings</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="openid-connect-provider">OpenId Connect Provider</h1>
<h2 id="introduction">Introduction</h2>
<p>To provide a login mechanism for the user, at least one OpenId Connect Provider
is needed.</p>
<p>WaTTS needs to be registered as a client with OpenId Connect Provider. For this,
you need to perform the registration process at the Provider of your choice. The
registration process depends heavily on the Provider and is out of the scope of this
documentation, if you are unsure you can ask the provider.</p>
<p>During the registration, some information needs to be provided.
The redirect <em>uri</em> is created from three settings:</p>
<ul>
<li><code>ssl</code>: http:// (false, default) or https:// (true)</li>
<li><code>hostname</code>: localhost (default)</li>
<li><code>port</code>: 8080 (default)</li>
<li>fix path: /oidc</li>
</ul>
<p>For the default settings this results in the redirect uri:
<a href="http://localhost:8080/oidc" target="_blank">http://localhost:8080/oidc</a>.</p>
<p>The redirect uri for the settings &apos;SSL = true&apos;, &apos;Port = 443&apos;, &apos;HostName=<a href="GLOSSARY.html#tts" class="glossary-term" title="shortage for Token Translation Service">tts</a>.example.com&apos;
would be <a href="https://tts.example.com/oidc" target="_blank">https://tts.example.com/oidc</a> (the port is not added as it is the default
port for https, it would be the same for port 80 on SSL = false).</p>
<p>If you are unsure, just start the WaTTS and check the logs. During the start of WaTTS, it prints
some messages starting with <code>Init:</code>, one of them is <code>Init: using local endpoint ....</code>
telling you which uri to use.</p>
<p>WaTTS uses the &apos;code-auth-flow&apos; and is a &apos;web-application&apos;.</p>
<h4 id="general-settings">General Settings</h4>
<p>WaTTS verifies the complete SSL chain if https is used and is very strict to ensure the
integrity for the user using WaTTS.</p>
<p>To be able to verify a remote certificate WaTTS needs to know where the supported certification
authority certificates are stored. The second information WaTTS needs is the allowed depth of
CA and intermediate CAs to have before reaching the server certificate.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Key</th>
<th>Description</th>
<th style="text-align:center">Datatype</th>
<th style="text-align:center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">oidc.cacertfile</td>
<td>The file containing all trusted CAs</td>
<td style="text-align:center">file</td>
<td style="text-align:center">none</td>
</tr>
<tr>
<td style="text-align:center">oidc.cert_depth</td>
<td>The number of intermediate CAs allowd</td>
<td style="text-align:center">integer</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">oidc.cache_duration</td>
<td>The time, in seconds, http request to userinfo/tokeninfo are allowed to get cacheed. The purpose is to keep high load from the OpenId Connect Provider. Yet this also means that there is a 90 second window in which a user might still be allowed to perform actions although he has been blocked at the IdP</td>
<td style="text-align:center">integer, &apos;none&apos;</td>
<td style="text-align:center">90</td>
</tr>
<tr>
<td style="text-align:center">oidc.cache_clean</td>
<td>The amount of time (in seconds) to wait before cleaning up the cache</td>
<td style="text-align:center">integer</td>
<td style="text-align:center">300</td>
</tr>
<tr>
<td style="text-align:center">oidc.request_timeout</td>
<td>The number of seconds an http request is allowed to take</td>
<td style="text-align:center">integer</td>
<td style="text-align:center">300</td>
</tr>
<tr>
<td style="text-align:center">oidc.use_cookie</td>
<td>If cookies should be used to identify the user during login</td>
<td style="text-align:center">boolean</td>
<td style="text-align:center">true</td>
</tr>
<tr>
<td style="text-align:center">oidc.check_user_agent</td>
<td>Wether the user agent identifier should be verified</td>
<td style="text-align:center">boolean</td>
<td style="text-align:center">true</td>
</tr>
<tr>
<td style="text-align:center">oidc.check_peer_ip</td>
<td>Should the remote IP be checked when logging in the user</td>
<td style="text-align:center">boolean</td>
<td style="text-align:center">true</td>
</tr>
</tbody>
</table>
<h2 id="example">Example</h2>
<pre><code># this should be the setting on debian based systems if you want to trust the default bundle
oidc.cacertfile = /etc/ssl/certs/ca-certificates.crt
# this should be the setting on centos systems if you want to trust the default bundle
oidc.cacertfile = /etc/ssl/certs/ca-bundle.crt

# on both systems you can cange the allowed depth by
oidc.cert_depth = 5
</code></pre><h2 id="provider-settings">Provider Settings</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Key</th>
<th>Description</th>
<th style="text-align:center">Datatype</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">description</td>
<td>A description of the Provider, shown at the login Screen</td>
<td style="text-align:center">string</td>
</tr>
<tr>
<td style="text-align:center">client_id</td>
<td>The client id received at the registration</td>
<td style="text-align:center">string</td>
</tr>
<tr>
<td style="text-align:center">client_secret</td>
<td>The client secret received at the registration</td>
<td style="text-align:center">string</td>
</tr>
<tr>
<td style="text-align:center">config_endpoint</td>
<td>The configuration endpoint of the provider, ensure you are using ssl</td>
<td style="text-align:center">url</td>
</tr>
<tr>
<td style="text-align:center">request_scopes</td>
<td>the scopes to request</td>
<td style="text-align:center">comma separated list</td>
</tr>
</tbody>
</table>
<p>Each setting is prefixed with &apos;openid.<code>id</code>.&apos; where <code>id</code> must be replaced by the id
you want to give to the provider. The <code>id</code> MUST not be &apos;any&apos; or start with &apos;rsp&apos;.</p>
<h2 id="example">Example</h2>
<p>An example for the IAM OpenId Connect Provider, setting its id to <code>iam</code>:</p>
<pre><code>openid.iam.description = INDIGO Datacloud Identity and Access Management (IAM)
openid.iam.client_id = &lt;insert the client id&gt;
opemid.iam.client_secret =  &lt;insert the client secret&gt;
openid.iam.config_endpoint = https://iam-test.indigo-datacloud.eu/.well-known/openid-configuration
openid.iam.request_scopes = openid, profile
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="config_server.html" class="navigation navigation-prev " aria-label="Previous page: Server Settings">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="config_service.html" class="navigation navigation-next " aria-label="Next page: Service Settings">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"OpenId Connect Provider Settings","level":"1.4.3","depth":2,"next":{"title":"Service Settings","level":"1.4.4","depth":2,"path":"config_service.md","ref":"config_service.md","articles":[]},"previous":{"title":"Server Settings","level":"1.4.2","depth":2,"path":"config_server.md","ref":"config_server.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"root":"./gitbook","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"config_provider.md","mtime":"2017-10-20T11:42:20.453Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-10-25T13:01:09.812Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

