<html>
    <body>
        <h1>Welcome</h1>
        this is your user page, you are logged in as {{ username }}.<br>
        <br>
        {% if service_list %}
        <h2>Services</h2>
        <table>
        {% for service in service_list %}
            <tr>
            <form method="post" action="{{ ep_user }}">
            <input type="hidden" name="service_id" value="{{ service.id }}" >
                <td> {{ service.type }}  </td> 
                <td> {{ service.host }}  </td> 
                <td> {{ service.description }}  </td> 
                {% if service.has_credential %}
                    <td> 
                        <button type="submit">Revoke</button> 
                        <input type="hidden" name="action" value="revoke" >
                    </td>
                {% else %}
                    <td>
                        <button type="submit">Request</button> 
                        <input type="hidden" name="action" value="request" >
                    </td>
                {% endif %}
            </form> 
            </tr>
        {% endfor %}
        </table>
        {% else %}
        You are not able to request/revoke any credentials 
        {% endif %}
        {% if credential %}
        <h2>Credential</h2>
        This information will be gone once you perform any action, the
        credential is also not stored on the server
        <table>
        {% for keyvalue in credential %}
            <tr>
                <td> {{ keyvalue.name }}  </td> 
                <td> {{ keyvalue.value }}  </td> 
            </tr>
        {% endfor %}
        </table>
        {% endif %}
        {% if credential_log %}
        <h3>Log</h3>
        The log of executing the ssh-commands
        <table>
            <tr>
                <th> Command  </th> 
                <th> Exit Status  </th> 
                <th> Std Out  </th> 
                <th> Std Err  </th> 
            </tr>
        {% for log in credential_log %}
            <tr>
                <td> {{ log.cmd }}  </td> 
                <td> {{ log.exit_status }}  </td> 
                <td> {{ log.std_out }}  </td> 
                <td> {{ log.std_err }}  </td> 
            </tr>
        {% endfor %}
        </table>

        {% endif %}
        <br>
        <form method="post" action="{{ ep_user }}">
        <input type="hidden" name="action" value="logout" >
        <button type="submit">Logout</button> 
        </form> 
    </body>
</html>
